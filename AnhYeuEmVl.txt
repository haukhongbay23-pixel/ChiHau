local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- [B·∫¢O M·∫¨T] M√£ h√≥a Key: CHII_HAUU_2026
local obfuscated_key = {67, 72, 73, 73, 95, 72, 65, 85, 85, 95, 50, 48, 50, 54} 
local function get_key(bytes)
    local k = ""
    for i = 1, #bytes do k = k .. string.char(bytes[i]) end
    return k
end

local CorrectKey = get_key(obfuscated_key)
local HasKey = false
_G.AutoFarmChest = false
_G.IsTeleporting = false
_G.FarmSpeed = 120 

local TweenService = game:GetService("TweenService")

-- 1. Ki·ªÉm tra Sea hi·ªán t·∫°i
local function GetCurrentSea()
    local placeId = game.PlaceId
    if placeId == 2753915549 then return "Sea 1"
    elseif placeId == 4442245419 then return "Sea 2"
    elseif placeId == 7449925069 then return "Sea 3"
    else return "Unknown" end
end

local CurrentSea = GetCurrentSea()

-- H√†m Bay (Tween) ƒë·∫øn m·ª•c ti√™u
local function TweenTo(targetCFrame)
    local char = game.Players.LocalPlayer.Character
    local root = char and char:FindFirstChild("HumanoidRootPart")
    if root then
        local distance = (root.Position - targetCFrame.Position).Magnitude
        local duration = distance / _G.FarmSpeed
        local info = TweenInfo.new(duration, Enum.EasingStyle.Linear)
        local tween = TweenService:Create(root, info, {CFrame = targetCFrame})
        tween:Play()
        return tween
    end
end

-- 2. N√öT TR√íN B·∫¨T/T·∫ÆT MENU (ƒê√£ fix l·ªói t·∫°o l·∫∑p)
local function CreateToggleButton()
    if game:GetService("CoreGui"):FindFirstChild("ChiiHauuToggle") then
        game:GetService("CoreGui").ChiiHauuToggle:Destroy()
    end
    
    local ScreenGui = Instance.new("ScreenGui")
    local ImageButton = Instance.new("ImageButton")
    local UICorner = Instance.new("UICorner")
    
    ScreenGui.Name = "ChiiHauuToggle"
    ScreenGui.Parent = game:GetService("CoreGui")
    
    ImageButton.Parent = ScreenGui
    ImageButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    ImageButton.Position = UDim2.new(0.12, 0, 0.15, 0)
    ImageButton.Size = UDim2.new(0, 50, 0, 50)
    ImageButton.Image = "rbxassetid://88038667117291"
    ImageButton.Draggable = true
    
    UICorner.CornerRadius = UDim.new(1, 0)
    UICorner.Parent = ImageButton
    
    ImageButton.MouseButton1Click:Connect(function()
        local main = game:GetService("CoreGui"):FindFirstChild("Rayfield")
        if main and main:FindFirstChild("Main") then
            main.Main.Visible = not main.Main.Visible
        end
    end)
end
CreateToggleButton()

local Window = Rayfield:CreateWindow({
   Name = "üè¥‚Äç‚ò†Ô∏è Blox Fruits: Chii Hauu HUB",
   LoadingTitle = "H·ªá Th·ªëng Farm R∆∞∆°ng T·ªëc ƒê·ªô Cao",
   LoadingSubtitle = "by Chii Hauu | " .. CurrentSea,
   KeySystem = false, 
   Keybind = "LeftControl"
})

-- 3. Logic Farm R∆∞∆°ng
function doFarmChest()
    task.spawn(function()
        while _G.AutoFarmChest do
            task.wait()
            local char = game.Players.LocalPlayer.Character
            local root = char and char:FindFirstChild("HumanoidRootPart")
            if root then
                local targetChest = nil
                local minDist = math.huge
                for _, v in pairs(game.Workspace:GetDescendants()) do
                    if v:IsA("BasePart") and v.Name:find("Chest") then
                        local dist = (v.Position - root.Position).Magnitude
                        if dist < minDist then
                            minDist = dist
                            targetChest = v
                        end
                    end
                end

                if targetChest then
                    _G.IsTeleporting = true
                    local tween = TweenTo(targetChest.CFrame * CFrame.new(0, 2, 0))
                    repeat task.wait() until not targetChest.Parent or not _G.AutoFarmChest
                    if tween then tween:Cancel() end
                    _G.IsTeleporting = false
                else
                    task.wait(2)
                end
            end
        end
    end)
end

-- 4. Noclip
game:GetService("RunService").Stepped:Connect(function()
    local char = game.Players.LocalPlayer.Character
    if char and (_G.AutoFarmChest or _G.IsTeleporting) then
        for _, v in pairs(char:GetDescendants()) do
            if v:IsA("BasePart") then v.CanCollide = false end
        end
    end
end)

-- TABS
local KeyTab = Window:CreateTab("üîë Key")
local MainTab = Window:CreateTab("üí∞ Farm R∆∞∆°ng")
local TeleportTab = Window:CreateTab("üèùÔ∏è D·ªãch Chuy·ªÉn")

KeyTab:CreateInput({
   Name = "Nh·∫≠p Key",
   PlaceholderText = "Nh·∫≠p key t·∫°i ƒë√¢y...",
   Callback = function(Text)
      if Text == CorrectKey then 
         HasKey = true 
         Rayfield:Notify({Title = "TH√ÄNH C√îNG", Content = "Ch√†o Chii Hauu!", Duration = 5})
      else
         Rayfield:Notify({Title = "SAI KEY", Content = "Vui l√≤ng ki·ªÉm tra l·∫°i!", Duration = 5})
      end
   end,
})

MainTab:CreateSlider({
   Name = "T·ªëc ƒë·ªô nh·∫∑t",
   Range = {50, 300},
   Increment = 10,
   Suffix = "Speed",
   CurrentValue = 120,
   Callback = function(Value) _G.FarmSpeed = Value end,
})

MainTab:CreateToggle({
   Name = "B·∫≠t Auto Farm Chest",
   CurrentValue = false,
   Callback = function(Value)
      if HasKey then
         _G.AutoFarmChest = Value
         if Value then doFarmChest() end
      else
         Rayfield:Notify({Title = "L·ªñI", Content = "H√£y nh·∫≠p Key!", Duration = 5})
      end
   end,
})

-- 5. D·ªãch chuy·ªÉn ƒê·∫£o (ƒê√£ fix l·ªói thi·∫øu code)
local Islands = {
    ["Sea 1"] = {["ƒê·∫£o Kh·ªüi ƒê·∫ßu"] = CFrame.new(-483, 20, 4291), ["ƒê·∫£o Kh·ªâ"] = CFrame.new(-1246, 12, 4747)},
    ["Sea 2"] = {["Qu√°n Cafe"] = CFrame.new(-380, 77, 255)},
    ["Sea 3"] = {["Mansion"] = CFrame.new(-12463, 374, -7551)}
}

local SeaData = Islands[CurrentSea]
if SeaData then
    for Name, CF in pairs(SeaData) do
        TeleportTab:CreateButton({
            Name = "ƒê·∫øn: " .. Name,
            Callback = function()
                if HasKey then 
                    _G.IsTeleporting = true
                    TweenTo(CF)
                    task.wait(2)
                    _G.IsTeleporting = false
                else
                    Rayfield:Notify({Title = "L·ªñI", Content = "Ch∆∞a nh·∫≠p Key!", Duration = 5})
                end
            end
        })
    end
end

MainTab:CreateButton({
   Name = "üõë D·ª´ng Script",
   Callback = function()
      _G.AutoFarmChest = false
      if game:GetService("CoreGui"):FindFirstChild("ChiiHauuToggle") then
          game:GetService("CoreGui").ChiiHauuToggle:Destroy()
      end
      Rayfield:Destroy()
   end,
})
